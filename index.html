

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Excel Migration Tool</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<style>
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #121212;
    color: #e0e0e0;
    margin: 0;
}
    /* Welcome Page Styles */
#welcomePage {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    height: 100vh;
    background: #121212;
    color: #00e676;
    text-align: center;
    padding: 20px;
}
#welcomePage h1 {
    font-size: 3rem;
    margin-bottom: 20px;
}
#welcomePage p {
    font-size: 1.2rem;
    margin-bottom: 30px;
    max-width: 400px;
}
#welcomePage button {
    padding: 15px 30px;
    font-size: 1.2rem;
    background: #00e676;
    color: #121212;
    border: none;
    border-radius: 10px;
    cursor: pointer;
}
#welcomePage button:hover {
    background: #00c853;
}
header {
    background: #1f1f1f;
    color: #00e676;
    padding: 15px 20px;
    font-size: 1.6rem;
    font-weight: bold;
    box-shadow: 0 2px 6px rgba(0,0,0,0.5);
}
main {
    display: none; /* Hide initially */
    flex-wrap: wrap;
    padding: 20px;
    gap: 20px;
}

.sidebar {
    width: 280px;
    background: #1a1a1a;
    padding: 15px;
    border-radius: 10px;
    color: #e0e0e0;
    display: flex;
    flex-direction: column;
    gap: 12px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.6);
}
.sidebar button, .sidebar input {
    padding: 10px;
    font-size: 1rem;
    border-radius: 5px;
    border: none;
    cursor: pointer;
}
.sidebar button {
    background: #00e676;
    color: #121212;
    font-weight: bold;
    transition: 0.2s;
}
.sidebar button:hover {
    background: #00c853;
}
.sidebar input {
    background: #2a2a2a;
    color: #e0e0e0;
}
.content {
    flex: 1;
    min-width: 300px;
    display: flex;
    flex-direction: column;
    gap: 20px;
    height: calc(100vh - 60px); /* Fill viewport minus header height */
}

table {
    width: 100%;
    border-collapse: collapse;
    background: #1f1f1f;
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0,0,0,0.5);
}
th, td {
    padding: 10px;
    text-align: left;
    border-bottom: 1px solid #333;
}
th {
    background: #333;
    color: #00e676;
    position: sticky;
    top: 0;
}
tr:nth-child(even) {
    background: #1a1a1a;
}
tr:hover {
    background: #333;
}
.scrollable {
    flex: 1;           /* Grow to fill remaining space */
    overflow-y: auto;  /* Scroll if content exceeds height */
    border-radius: 10px;
}

.debit { color: #00e676; font-weight: bold; }
.credit { color: #ff5252; font-weight: bold; }
.highlight { background: #ff9800 !important; color: #000; }
@media(max-width: 768px){
    main { flex-direction: column; }
    .sidebar { width: 100%; }
}

    .tabs {
  display: flex;
  gap: 10px;
  margin-bottom: 15px;
}
.tabButton {
  padding: 10px 20px;
  background: #1a1a1a;
  color: #e0e0e0;
  border: none;
  border-radius: 5px 5px 0 0;
  cursor: pointer;
  font-weight: bold;
  transition: 0.2s;
}
.tabButton.active {
  background: #00e676;
  color: #121212;
}
.tabButton:hover {
  background: #00c853;
}
.tabContent {
  display: none;
}

</style>
</head>
<body>
    <!-- Welcome Page -->
<div id="welcomePage" style="display:flex; flex-direction:column; justify-content:center; align-items:center; height:100vh; background:#121212; color:#00e676; text-align:center; padding:20px;">
    <h1 style="font-size:3rem; margin-bottom:20px;">Welcome to LEDGIOX</h1>
    <p style="font-size:1rem; margin-bottom:30px; max-width:500px;">
                     LEDGIOX is made by accountant, for accountants. 
          Quickly convert your Excel or CSV data into accurate Journal Entries and a complete General Ledger. 
                      Save time, reduce errors, and streamline your workflow. 
            Upload, generate, and export effortlessly to platforms like Zoho, QuickBooks, or Sage.
                    For suggestions or feedback, email us at ledgiox@gmail.com
    </p>
    <button id="getStartedBtn" style="padding:15px 30px; font-size:1.2rem; background:#00e676; color:#121212; border:none; border-radius:10px; cursor:pointer;">
        Get Started
    </button>
</div>

<header style="display:none;">LEDGIOX</header>
<main>
  <div class="sidebar">
    <label for="counterAccount">Counter Account</label>
    <input type="text" id="counterAccount" placeholder="Counter Account e.g. Bank">
    <label for="fileInput">Upload Excel/CSV</label>
    <input type="file" id="fileInput" accept=".xlsx,.csv">
    <button onclick="loadExcel()">Load Excel</button>
    <button onclick="generateJournal()">Generate Journal</button>
    <button onclick="generateLedger()">Generate General Ledger</button>
    <button onclick="downloadJournal()">Download Journal</button>
    <button onclick="downloadLedger()">Download Ledger</button>
    <button onclick="downloadSample()">Download Sample Excel</button>
    <label for="platformSelect">Export to Platform</label>
    <select id="platformSelect">
      <option value="">Select Platform</option>
      <option value="zoho">Zoho Books</option>
      <option value="quickbooks">QuickBooks</option>
      <option value="sage">Sage</option>
    </select>
    <button onclick="exportPlatform()">Export CSV</button>
  </div>

  <div class="content">
    <!-- Tabs -->
    <div class="tabs">
      <button class="tabButton active" onclick="openTab(event, 'sampleTab')">Sample Excel</button>
      <button class="tabButton" onclick="openTab(event, 'journalTab')">Journal Entries</button>
      <button class="tabButton" onclick="openTab(event, 'ledgerTab')">General Ledger</button>
    </div>

<div id="sampleTab" class="tabContent">
  <table id="sampleTable">
      <tr><th>Date</th><th>Description</th><th>Type</th><th>Amount</th><th>Account</th><th>Code Range</th><th>Category</th></tr>
  </table>
</div>

<div id="journalTab" class="tabContent">
  <div class="scrollable">
    <table id="journalTable">
        <tr><th>Date</th><th>Account</th><th>Code Range</th><th>Category</th><th>Debit</th><th>Credit</th><th>Description</th></tr>
    </table>
  </div>
</div>

<div id="ledgerTab" class="tabContent">
  <div class="scrollable">
    <table id="ledgerTable">
        <tr><th>Account</th><th>Code Range</th><th>Category</th><th>Date</th><th>Description</th><th>Debit</th><th>Credit</th><th>Balance</th></tr>
    </table>
  </div>
</div>

  </div>
</main>


<script>
let sheetData = [];
let journal = [];
let ledger = {};

const sampleData = [
  {Date:"2025-08-01", Description:"Office Supplies Purchase", Type:"Payment", Amount:120, Account:"office supplies"},
  {Date:"2025-08-02", Description:"Staff Lunch", Type:"Payment", Amount:45, Account:"staff food"},
  {Date:"2025-08-03", Description:"Legal Consultation", Type:"Payment", Amount:300, Account:"legal"},
  {Date:"2025-08-04", Description:"Product Sale", Type:"Receipt", Amount:500, Account:"sale"},
  {Date:"2025-08-05", Description:"Car Fuel", Type:"Payment", Amount:60, Account:"fuel"},
  {Date:"2025-08-06", Description:"Asset Purchased – Computer", Type:"Payment", Amount:800, Account:"computer"},
  {Date:"2025-08-07", Description:"Asset Sold – Printer", Type:"Receipt", Amount:200, Account:"computer"},
  {Date:"2025-08-08", Description:"Discount Received", Type:"Receipt", Amount:50, Account:"discount received"},
  {Date:"2025-08-09", Description:"Stationery Purchase", Type:"Payment", Amount:70, Account:"stationery"},
  {Date:"2025-08-10", Description:"Staff Snacks", Type:"Payment", Amount:30, Account:"staff food"},
  {Date:"2025-08-11", Description:"Sales Returned – Product A", Type:"Payment", Amount:100, Account:"return"},
  {Date:"2025-08-12", Description:"Legal Fee", Type:"Payment", Amount:250, Account:"legal"},
  {Date:"2025-08-13", Description:"Printing Flyers", Type:"Payment", Amount:150, Account:"printing"},
  {Date:"2025-08-14", Description:"Misc Expenses", Type:"Payment", Amount:60, Account:"misc"},
  {Date:"2025-08-15", Description:"Owner Capital Contribution", Type:"Receipt", Amount:1000, Account:"capital"},
  {Date:"2025-08-16", Description:"Owner Drawing", Type:"Payment", Amount:200, Account:"drawing"},
  {Date:"2025-08-17", Description:"Bank Interest Income", Type:"Receipt", Amount:75, Account:"interest"},
  {Date:"2025-08-18", Description:"Loan Repayment", Type:"Payment", Amount:500, Account:"loan"}
];

const accountCodes = {
   "Asset": { min: 1000, max: 1999, description: "Current & Fixed Assets" },
    "Liability": { min: 2000, max: 2999, description: "Current & Long-term Liabilities" },
    "Equity": { min: 3000, max: 3999, description: "Owner's Equity & Capital" },
    "Revenue": { min: 4000, max: 4499, description: "Operating Revenue" },
    "Contra Revenue": { min: 4500, max: 4599, description: "Returns & Discounts" },
    "Cost of Sales": { min: 5000, max: 5299, description: "Cost of Goods Sold / Direct Costs" },
    "Operating Expense": { min: 5300, max: 5999, description: "Operating Expenses" },
    "Administrative Expense": { min: 6000, max: 6999, description: "Admin & General Expenses" },
    "Other Income/Expense": { min: 7000, max: 7999, description: "Non-operating / Other Income & Expenses" },
    "Extraordinary": { min: 8000, max: 8999, description: "Extraordinary Items" }
};

const accountMapping = {
  // Assets
    "cash": 1000,
    "bank": 1010,
    "petty cash": 1020,
    "accounts receivable": 1100,
    "allowance doubtful accounts": 1110,
    "inventory": 1200,
    "raw materials": 1210,
    "work in progress": 1220,
    "finished goods": 1230,
    "prepaid expenses": 1300,
    "fixed assets": 1400,
    "accumulated depreciation": 1410,
    "buildings": 1420,
    "vehicles": 1430,
    "office equipment": 1440,
    "intangible assets": 1500,
    "other current assets": 1600,

    // Liabilities
    "accounts payable": 2000,
    "credit cards": 2100,
    "accrued expenses": 2200,
    "taxes payable": 2300,
    "short term loans": 2400,
    "long term debt": 2500,
    "employee benefits payable": 2600,
    "unearned revenue": 2700,
    "other current liabilities": 2800,

    // Equity
    "capital": 3000,
    "retained earnings": 3100,
    "drawing": 3200,
    "additional paid-in capital": 3300,
    "reserves": 3400,
    "treasury shares": 3500,

    // Revenue
    "sale": 4000,
    "product sales": 4010,
    "service revenue": 4020,
    "rental income": 4100,
    "interest": 4200,
    "other operating income": 4300,

    // Contra Revenue
    "return": 4500,
    "discount allowed": 4510,

    // Cost of Sales
    "cost of goods sold": 5000,
    "direct materials": 5100,
    "raw material purchases": 5110,
    "direct labor": 5120,
    "manufacturing overhead": 5200,
    "factory rent": 5210,
    "factory utilities": 5220,

    // Operating Expenses
    "salaries & wages": 5300,
    "employee benefits": 5310,
    "rent expense": 5400,
    "utilities": 5410,
    "electricity": 5411,
    "water": 5412,
    "internet/communication": 5413,
    "insurance": 5500,
    "depreciation expense": 5600,
    "marketing & advertising": 5700,
    "office supplies": 5800,
    "travel & entertainment": 5900,

    // Administrative & General Expenses
    "legal & professional fees": 6000,
    "training & development": 6100,
    "repairs & maintenance": 6200,
    "communication expense": 6300,
    "bank charges": 6400,
    "software subscriptions": 6500,
    "miscellaneous expense": 6600,

    // Other Income & Expenses
    "interest expense": 7100,
    "gain/loss on asset disposal": 7200,
    "foreign exchange gain/loss": 7300,

    // Extraordinary / Non-Operating
    "extraordinary gains": 8100,
    "extraordinary losses": 8200
};

// --- Detect Account safely ---
function detectAccount(description) {
    const lower = description ? description.toLowerCase() : "";
    for (const acc in accountMapping) {
        if (lower.includes(acc.toLowerCase())) return acc;
    }
    return "Misc";
}

// --- Get category from code ---
function getAccountTypeByCode(code) {
    for (const [type, range] of Object.entries(accountCodes)) {
        if (code >= range.min && code <= range.max) return type;
    }
    return "Unknown";
}

// --- Format Excel/Date ---
function formatDate(excelDate) {
    if (!excelDate) return "";
    if (!isNaN(excelDate)) {
        const jsDate = new Date((excelDate - 25569) * 86400 * 1000);
        return jsDate.toISOString().split("T")[0];
    }
    const parts = excelDate.split(/[-\/]/);
    if (parts.length === 3) {
        let day, month, year;
        if (parts[0].length === 4) [year, month, day] = parts;
        else [day, month, year] = parts;
        const parsed = new Date(`${year}-${month}-${day}`);
       if (!isNaN(parsed.getTime())) return parsed.toISOString().split("T")[0];
    }
    const fallback = new Date(excelDate);
    return !isNaN(fallback) ? fallback.toISOString().split("T")[0] : "";
}

// --- Populate sample table ---
// --- Populate Sample Table with General Code Range ---
function populateSample() {
    const table = document.getElementById('sampleTable');
    table.innerHTML = `<tr>
        <th>Date</th>
        <th>Description</th>
        <th>Type</th>
        <th>Amount</th>
        <th>Account</th>
        <th>Code Range</th>
        <th>Category</th>
    </tr>`;

    sampleData.forEach(row => {
        const code = accountMapping[row.Account] || 0;
        const category = getAccountTypeByCode(code);
        let range = '';
        if(category && accountCodes[category]){
            range = `${accountCodes[category].min} - ${accountCodes[category].max}`;
        }

        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${row.Date}</td>
                        <td>${row.Description}</td>
                        <td>${row.Type}</td>
                        <td>${row.Amount}</td>
                        <td>${row.Account}</td>
                        <td>${range}</td>       <!-- General Code Range -->
                        <td>${category}</td>`;  <!-- General Category -->
        table.appendChild(tr);
    });
}



function validateSheet(data){
    const required = ["Date","Description","Type","Amount"];
    for(const row of data){
        for(const key of required){
            if(!(key in row) || row[key]==="") return false;
        }
    }
    return true;
}

function loadExcel() {
    const file = document.getElementById('fileInput').files[0];
    if(!file){ alert("Select a file first!"); return; }
    const reader = new FileReader();
    reader.onload = function(e){
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data,{type:"array"});
        const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
        const jsonData = XLSX.utils.sheet_to_json(firstSheet);
        if(!validateSheet(jsonData)){ alert("Excel missing required columns!"); return; }
        sheetData = jsonData;
        displaySheet(sheetData);
        alert("Excel loaded successfully!");
    }
    reader.readAsArrayBuffer(file);
}

function displaySheet(data){
    const table = document.getElementById('sampleTable');
    table.innerHTML = `<tr>
        <th>Date</th><th>Description</th><th>Type</th><th>Amount</th>
        <th>Account</th><th>Code Range</th><th>Category</th>
    </tr>`;
    data.forEach(row => {
        const account = detectAccount(row.Description);
        const category = getAccountTypeByCode(accountMapping[account] || 0);
        const range = getCodeRange(account);

        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${formatDate(row.Date)}</td>
                        <td>${row.Description}</td>
                        <td>${row.Type}</td>
                        <td>${row.Amount}</td>
                        <td>${account}</td>
                        <td>${range}</td>
                        <td>${category}</td>`;
        table.appendChild(tr);
    });
}

 

function generateJournal(){
    if(sheetData.length===0){ alert("Load data first!"); return; }
    journal = [];
    ledger = {};
    const counterAccount = document.getElementById('counterAccount').value || "Cash";

    sheetData.forEach(row => {
        const acc = detectAccount(row.Description);
        const code = accountMapping[acc] || 0;
        const category = getAccountTypeByCode(code);
        const amount = parseFloat(row.Amount);
        const date = formatDate(row.Date);

        if(row.Type.toLowerCase()==="payment"){
            journal.push({Date:date,Account:acc,Code:code,Category:category,Debit:amount,Credit:0,Description:row.Description});
            journal.push({Date:date,Account:counterAccount,Code:0,Category:"Cash",Debit:0,Credit:amount,Description:row.Description});
        } else {
            journal.push({Date:date,Account:counterAccount,Code:0,Category:"Cash",Debit:amount,Credit:0,Description:row.Description});
            journal.push({Date:date,Account:acc,Code:code,Category:category,Debit:0,Credit:amount,Description:row.Description});
        }
    });
    displayJournal();
    alert("Journal generated!");
}

function displayJournal() {
    const table = document.getElementById('journalTable');
    table.innerHTML = '<tr><th>Date</th><th>Account</th><th>Code Range</th><th>Category</th><th>Debit</th><th>Credit</th><th>Description</th></tr>';

    const fragment = document.createDocumentFragment();
    journal.forEach(entry => {
        const range = getCodeRange(entry.Account);
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${entry.Date}</td>
                        <td>${entry.Account}</td>
                        <td>${range}</td>
                        <td>${entry.Category}</td>
                        <td class="debit">${entry.Debit || ''}</td>
                        <td class="credit">${entry.Credit || ''}</td>
                        <td>${entry.Description}</td>`;
        fragment.appendChild(tr);
    });
    table.appendChild(fragment);
}



function generateLedger(){
    if(journal.length===0){ alert("Generate journal first!"); return; }
    ledger = {};
    journal.forEach(entry => {
        if(!ledger[entry.Account]) ledger[entry.Account] = [];
        ledger[entry.Account].push({...entry});
    });
    displayLedger();
    alert("General Ledger generated!");
}

function displayLedger() {
    const table = document.getElementById('ledgerTable');
    table.innerHTML = '<tr><th>Account</th><th>Code Range</th><th>Category</th><th>Date</th><th>Description</th><th>Debit</th><th>Credit</th><th>Balance</th></tr>';

    const fragment = document.createDocumentFragment();
    for (const acc in ledger) {
        let balance = 0;
        ledger[acc].forEach(entry => {
            balance += (entry.Debit || 0) - (entry.Credit || 0);
            const range = getCodeRange(entry.Account);
            const tr = document.createElement('tr');
            tr.innerHTML = `<td>${entry.Account}</td>
                            <td>${range}</td>
                            <td>${entry.Category}</td>
                            <td>${entry.Date}</td>
                            <td>${entry.Description}</td>
                            <td class="debit">${(entry.Debit||0).toFixed(2)}</td>
                            <td class="credit">${(entry.Credit||0).toFixed(2)}</td>
                            <td>${balance.toFixed(2)}</td>`;
            fragment.appendChild(tr);
        });
    }
    table.appendChild(fragment);
}

function downloadJournal(){
    if(journal.length===0){ 
        alert("Generate journal first!"); 
        return; 
    }

    const exportData = journal.map(entry => ({
        Date: entry.Date,
        Account: entry.Account,
        CodeRange: getCodeRange(entry.Account),
        Category: entry.Category,
        Debit: entry.Debit,
        Credit: entry.Credit,
        Description: entry.Description
    }));

    const ws = XLSX.utils.json_to_sheet(exportData);
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, ws, "Journal");
    XLSX.writeFile(wb, "Journal.xlsx");
}

function downloadLedger(){
    if(Object.keys(ledger).length === 0){
        alert("Generate ledger first!");
        return;
    }

    const monthlyLedger = {};

  for(const acc in ledger){
    ledger[acc].forEach(entry => {
        const dateObj = new Date(entry.Date);
        const ym = `${dateObj.getFullYear()}-${String(dateObj.getMonth()+1).padStart(2,'0')}`;
        if(!monthlyLedger[ym]) monthlyLedger[ym] = [];

        // calculate balance separately inside each month
        let balance = 0;
        monthlyLedger[ym].push({
            Account: acc,
            CodeRange: getCodeRange(acc),
            Category: entry.Category,
            Date: entry.Date,
            Description: entry.Description,
            Debit: entry.Debit || 0,
            Credit: entry.Credit || 0,
            Balance: 0 // placeholder, we’ll recalc below
        });
    });
}

// Recalculate balance per month
for(const ym in monthlyLedger){
    let balances = {};
    monthlyLedger[ym] = monthlyLedger[ym].map(entry => {
        if(!balances[entry.Account]) balances[entry.Account] = 0;
        balances[entry.Account] += (entry.Debit || 0) - (entry.Credit || 0);
        return {...entry, Balance: balances[entry.Account]};
    });
}


    for(const month in monthlyLedger){
        const ws = XLSX.utils.json_to_sheet(monthlyLedger[month]);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, "Ledger");
        XLSX.writeFile(wb, `Ledger_${month}.xlsx`);
    }

    alert("Ledger exported as monthly files!");
}


function exportPlatform() {
    if (!journal || journal.length === 0) {
        alert("No journal data to export!");
        return;
    }

    const platform = document.getElementById("platformSelect").value;
    if (!platform) { 
        alert("Select a platform!"); 
        return; 
    }

    let exportData = [];

    if (platform === "zoho") {
        exportData = journal.map(entry => ({
            "Date": entry.Date,
            "Account Name": entry.Account,
            "CodeRange": getCodeRange(entry.Account),  // use general code range
            "Category": entry.Category,
            "Debit": entry.Debit,
            "Credit": entry.Credit,
            "Description": entry.Description
        }));
    } else if (platform === "quickbooks") {
        exportData = journal.map(entry => ({
            "TxnDate": entry.Date,
            "Account": entry.Account,
            "CodeRange": getCodeRange(entry.Account),  // use general code range
            "Category": entry.Category,
            "Debit": entry.Debit,
            "Credit": entry.Credit,
            "Memo": entry.Description
        }));
    } else if (platform === "sage") {
        exportData = journal.map(entry => ({
            "Date": entry.Date,
            "NominalCodeRange": getCodeRange(entry.Account), // use general code range
            "Category": entry.Category,
            "Description": entry.Description,
            "DebitAmount": entry.Debit || 0,
            "CreditAmount": entry.Credit || 0
        }));
    }

    // Convert to CSV
    function convertToCSV(objArray) {
        const array = typeof objArray !== 'object' ? JSON.parse(objArray) : objArray;
        let str = '';
        const headers = Object.keys(array[0]).join(',');
        str += headers + '\r\n';

        array.forEach(item => {
            let line = [];
            for (let key in item) {
                let val = item[key] != null ? item[key] : '';
                val = `"${val.toString().replace(/"/g, '""')}"`;
                line.push(val);
            }
            str += line.join(',') + '\r\n';
        });
        return str;
    }

    // Trigger download
    const csv = convertToCSV(exportData);
    const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.setAttribute('download', `${platform}_Export.csv`);
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);

    alert(`Journal exported for ${platform}!`);
}


function getCodeRange(account) {
    const code = accountMapping[account] || 0;
    const category = getAccountTypeByCode(code);
    if(category && accountCodes[category]){
        return `${accountCodes[category].min} - ${accountCodes[category].max}`;
    }
    return '';
}
function downloadSample() {
    // Prepare sample data with code ranges and categories
    const sampleDataWithCodes = sampleData.map(row => {
        const category = getAccountTypeByCode(accountMapping[row.Account] || 0);
        const range = getCodeRange(row.Account);
        return {
            Date: row.Date,
            Description: row.Description,
            Type: row.Type,
            Amount: row.Amount,
            Account: row.Account,
            CodeRange: range,
            Category: category
        };
    });

    // Create worksheet for sample data
    const wsSample = XLSX.utils.json_to_sheet(sampleDataWithCodes, { 
        header: ["Date", "Description", "Type", "Amount", "Account", "CodeRange", "Category"]
    });

    // Prepare legend data
    const legendData = [
     // Assets
    "cash": { code: 1000, category: "Asset" },
    "bank": { code: 1010, category: "Asset" },
    "petty cash": { code: 1020, category: "Asset" },
    "accounts receivable": { code: 1100, category: "Asset" },
    "allowance doubtful accounts": { code: 1110, category: "Asset" },
    "inventory": { code: 1200, category: "Asset" },
    "raw materials": { code: 1210, category: "Asset" },
    "work in progress": { code: 1220, category: "Asset" },
    "finished goods": { code: 1230, category: "Asset" },
    "prepaid expenses": { code: 1300, category: "Asset" },
    "fixed assets": { code: 1400, category: "Asset" },
    "accumulated depreciation": { code: 1410, category: "Asset" },
    "buildings": { code: 1420, category: "Asset" },
    "vehicles": { code: 1430, category: "Asset" },
    "office equipment": { code: 1440, category: "Asset" },
    "intangible assets": { code: 1500, category: "Asset" },
    "other current assets": { code: 1600, category: "Asset" },

    // Liabilities
    "accounts payable": { code: 2000, category: "Liability" },
    "credit cards": { code: 2100, category: "Liability" },
    "accrued expenses": { code: 2200, category: "Liability" },
    "taxes payable": { code: 2300, category: "Liability" },
    "short term loans": { code: 2400, category: "Liability" },
    "long term debt": { code: 2500, category: "Liability" },
    "employee benefits payable": { code: 2600, category: "Liability" },
    "unearned revenue": { code: 2700, category: "Liability" },
    "other current liabilities": { code: 2800, category: "Liability" },

    // Equity
    "capital": { code: 3000, category: "Equity" },
    "retained earnings": { code: 3100, category: "Equity" },
    "drawing": { code: 3200, category: "Equity" },
    "additional paid-in capital": { code: 3300, category: "Equity" },
    "reserves": { code: 3400, category: "Equity" },
    "treasury shares": { code: 3500, category: "Equity" },

    // Revenue
    "sale": { code: 4000, category: "Revenue" },
    "product sales": { code: 4010, category: "Revenue" },
    "service revenue": { code: 4020, category: "Revenue" },
    "rental income": { code: 4100, category: "Revenue" },
    "interest": { code: 4200, category: "Revenue" },
    "other operating income": { code: 4300, category: "Revenue" },

    // Contra Revenue
    "return": { code: 4500, category: "Contra Revenue" },
    "discount allowed": { code: 4510, category: "Contra Revenue" },

    // Cost of Sales
    "cost of goods sold": { code: 5000, category: "Operating Expense" },
    "direct materials": { code: 5100, category: "Operating Expense" },
    "raw material purchases": { code: 5110, category: "Operating Expense" },
    "direct labor": { code: 5120, category: "Operating Expense" },
    "manufacturing overhead": { code: 5200, category: "Operating Expense" },
    "factory rent": { code: 5210, category: "Operating Expense" },
    "factory utilities": { code: 5220, category: "Operating Expense" },

    // Operating Expenses
    "salaries & wages": { code: 5300, category: "Operating Expense" },
    "employee benefits": { code: 5310, category: "Operating Expense" },
    "rent expense": { code: 5400, category: "Operating Expense" },
    "utilities": { code: 5410, category: "Operating Expense" },
    "electricity": { code: 5411, category: "Operating Expense" },
    "water": { code: 5412, category: "Operating Expense" },
    "internet/communication": { code: 5413, category: "Operating Expense" },
    "insurance": { code: 5500, category: "Operating Expense" },
    "depreciation expense": { code: 5600, category: "Operating Expense" },
    "marketing & advertising": { code: 5700, category: "Operating Expense" },
    "office supplies": { code: 5800, category: "Operating Expense" },
    "travel & entertainment": { code: 5900, category: "Operating Expense" },

    // Administrative & General Expenses
    "legal & professional fees": { code: 6000, category: "Administrative Expense" },
    "training & development": { code: 6100, category: "Administrative Expense" },
    "repairs & maintenance": { code: 6200, category: "Administrative Expense" },
    "communication expense": { code: 6300, category: "Administrative Expense" },
    "bank charges": { code: 6400, category: "Administrative Expense" },
    "software subscriptions": { code: 6500, category: "Administrative Expense" },
    "miscellaneous expense": { code: 6600, category: "Administrative Expense" },

    // Other Income & Expenses
    "interest expense": { code: 7100, category: "Other Income & Expenses" },
    "gain/loss on asset disposal": { code: 7200, category: "Other Income & Expenses" },
    "foreign exchange gain/loss": { code: 7300, category: "Other Income & Expenses" },

    // Extraordinary / Non-Operating
    "extraordinary gains": { code: 8100, category: "Extraordinary / Non-Operating" },
    "extraordinary losses": { code: 8200, category: "Extraordinary / Non-Operating" },
};


    // Create worksheet for legend
    const wsLegend = XLSX.utils.json_to_sheet(legendData, {
        header: ["Category", "CodeRange"]
    });

    // Create workbook and append sheets
    const wb = XLSX.utils.book_new();
    XLSX.utils.book_append_sheet(wb, wsSample, "Sample Data");
    XLSX.utils.book_append_sheet(wb, wsLegend, "Code Legend");

    // Export file
    XLSX.writeFile(wb, "SamplePettyCash.xlsx");
}


function openTab(evt, tabName) {
    // Hide all tab contents
    const tabContents = document.getElementsByClassName("tabContent");
    for (let i = 0; i < tabContents.length; i++) tabContents[i].style.display = "none";

    // Remove active class
    const tabButtons = document.getElementsByClassName("tabButton");
    for (let i = 0; i < tabButtons.length; i++) tabButtons[i].classList.remove("active");

    // Show selected tab
    document.getElementById(tabName).style.display = "block";
    evt.currentTarget.classList.add("active");

    // Only display if data exists
    if (tabName === "journalTab" && journal.length > 0) displayJournal();
    if (tabName === "ledgerTab" && Object.keys(ledger).length > 0) displayLedger();
}


window.onload = function() {
    populateSample();
    document.getElementById("sampleTab").style.display = "block"; // Show first tab
};

document.getElementById('getStartedBtn').addEventListener('click', () => {
    // Hide welcome page
    document.getElementById('welcomePage').style.display = 'none';

    // Show main content and header
    document.querySelector('main').style.display = 'flex';
    document.querySelector('header').style.display = 'block';
});



</script>


</body>
</html>



























